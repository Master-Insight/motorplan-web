---
import HamburgerIcon from "@/icons/Hamburger.astro";
import { config } from "config";

const pages = [
  {
    name: "Inicio",
    href: "/",
  },
  {
    name: "Planes",
    href: "/producto",
  },
  {
    name: "Adjudicados",
    href: "/adjudicados",
  },
  {
    name: "Institucional",
    href: "/institucional",
  },
  {
    name: "Contacto",
    href: "/contacto",
  },
  {
    name: "Mi Situación",
    href: "#",
    isProfile: true,
  },
];

const { pathname } = Astro.url;
const currentPath =
  pathname.endsWith("/") && pathname.length > 1
    ? pathname.slice(0, -1)
    : pathname;
---

<header
  id="header"
  class="fixed w-full bg-white shadow-md transition-transform duration-300 z-50 pt-2"
>
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a
        href="/"
        class="text-xl font-bold text-highlight flex items-center space-x-2"
      >
        <img
          src={config.images.logo[1]}
          alt="Logo de motorplan"
          class="w-auto h-20 pt-1"
        />
      </a>

      <!-- Barra de navegación -->
      <nav class="hidden md:block">
        <!-- Menú con dropdown -->
        <ul class="flex space-x-4 items-center pb-2">
          <!-- Menú de navegación -->
          <li class="relative group">
            <a
              href="/"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Inicio</a
            >
          </li>

          <li class="relative group">
            <a
              href="#"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Planes</a
            >
            <!-- Menú desplegable para desktop -->
            <ul
              class="absolute left-0 mt-2 space-y-1 bg-white rounded-md shadow-lg hidden"
              id="desktopDropdown"
            >
              <li>
                <a
                  href="/producto"
                  class="block py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
                  >Auto</a
                >
              </li>
              <li>
                <a
                  href="/producto"
                  class="block py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
                  >Usado</a
                >
              </li>
              <li>
                <a
                  href="/producto"
                  class="block py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
                  >Dinero</a
                >
              </li>
              <li>
                <a
                  href="/producto"
                  class="block py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
                  >Moto</a
                >
              </li>
              <li>
                <a
                  href="/producto"
                  class="block py-2 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
                  >Pack Hogar</a
                >
              </li>
            </ul>
          </li>

          <li class="relative">
            <a
              href="/adjudicados"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Adjudicados</a
            >
          </li>

          <li class="relative">
            <a
              href="/institucional"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Institucional</a
            >
          </li>

          <li class="relative">
            <a
              href="/contacto"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Contacto</a
            >
          </li>

          <li class="relative">
            <a
              href="#"
              class="items-center text-sm font-semibold transition-all duration-300 hover:text-secondary-light relative"
              >Mi Situación</a
            >
          </li>
        </ul>
      </nav>

      <!-- Botón del menú móvil (oculto en pantallas medianas y grandes) -->
      <button id="menuToggle" class="md:hidden" aria-label="Toggle Menu">
        <HamburgerIcon />
      </button>
    </div>
  </div>

  <!-- Menú móvil -->
  <div
    class="md:hidden max-h-0 opacity-0 overflow-hidden transition-all duration-300 ease-in-out"
    id="mobileMenu"
  >
    <nav class="px-4 pt-2 pb-4 bg-white">
      <ul class="space-y-2">
        <!-- Menú de navegación para móvil -->
        <li>
          <a
            href="/"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Inicio</a
          >
        </li>

        <li>
          <a
            href="#"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Planes</a
          >
          <ul class="ml-4 space-y-1 mt-1 hidden group-hover:block">
            <li>
              <a
                href="/producto"
                class="block py-2 px-4 text-sm font-medium transition-colors hover:bg-gray-100"
                >Auto</a
              >
            </li>
            <li>
              <a
                href="/producto"
                class="block py-2 px-4 text-sm font-medium transition-colors hover:bg-gray-100"
                >Usado</a
              >
            </li>
            <li>
              <a
                href="/producto"
                class="block py-2 px-4 text-sm font-medium transition-colors hover:bg-gray-100"
                >Dinero</a
              >
            </li>
            <li>
              <a
                href="/producto"
                class="block py-2 px-4 text-sm font-medium transition-colors hover:bg-gray-100"
                >Moto</a
              >
            </li>
            <li>
              <a
                href="/producto"
                class="block py-2 px-4 text-sm font-medium transition-colors hover:bg-gray-100"
                >Pack Hogar</a
              >
            </li>
          </ul>
        </li>

        <li>
          <a
            href="/adjudicados"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Adjudicados</a
          >
        </li>
        <li>
          <a
            href="/institucional"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Institucional</a
          >
        </li>
        <li>
          <a
            href="/contacto"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Contacto</a
          >
        </li>
        <li>
          <a
            href="#"
            class="block py-2 px-4 text-sm font-medium transition-colors"
            >Mi Situación</a
          >
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
  document.addEventListener("astro:page-load", () => {
    const menuToggle = document.getElementById("menuToggle");
    const mobileMenu = document.getElementById("mobileMenu");
    const desktopDropdown = document.getElementById("desktopDropdown"); // Nuevo

    let isMenuOpen = false;
    let isDropdownOpen = false; // Nuevo para manejar el dropdown

    menuToggle.addEventListener("click", () => {
      isMenuOpen = !isMenuOpen;
      mobileMenu.style.maxHeight = isMenuOpen
        ? `${mobileMenu.scrollHeight}px`
        : "0";
      mobileMenu.style.opacity = isMenuOpen ? "1" : "0";
      menuToggle.setAttribute("aria-expanded", isMenuOpen.toString());
    });

    // Lógica para el dropdown del menú de escritorio
    const dropdownToggle = document.querySelector('a[href="#"]'); // Suponiendo que el toggle es el <a> con href="#"

    dropdownToggle.addEventListener("click", (e) => {
      e.preventDefault(); // Prevenir la acción predeterminada (evitar que navegue)
      isDropdownOpen = !isDropdownOpen;
      desktopDropdown.style.display = isDropdownOpen ? "block" : "none"; // Mostrar/ocultar el dropdown
    });
  });
</script>
